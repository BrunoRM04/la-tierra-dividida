<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css">
    <link rel="stylesheet" href="../styles.css">
    <link rel="shortcut icon" href="../img/logotipos/la tierra dividida.png">
    <title>La Tierra Dividida | La asesina ilustrada</title>
</head>

<body>

    <div class="barra-podcast">
        <span class="texto-podcast">
            Un espacio de lectura de Mauro Tomasino y Sergio Requel
        </span>
    </div>

    <header class="encabezado-principal">
        <div class="contenedor-logotipo">
            <a href="../index.html"><img src="../img/logotipos/la tierra dividida.png" alt="Logotipo del sitio"
                    class="logotipo"></a>
        </div>
    </header>

    <main class="zona-detalle-resena">

        <section class="encabezado-resena">
            <h1 class="titulo-detalle">LA ASESINA ILUSTRADA</h1>
            <h2 class="autor-detalle">Enrique Vila-Matas</h2>
        </section>

        <section class="acciones-resena">
            <button class="boton-accion" id="boton-me-gusta">
                <i class="ri-heart-line"></i> Me gusta (<span id="contador-me-gusta">0</span>)
            </button>
            <button class="boton-accion" id="abrir-modal-compartir">
                <i class="ri-share-line"></i> Compartir
            </button>

            <div class="modal-compartir oculto" id="modal-compartir">
                <div class="contenido-modal-compartir">
                    <span id="cerrar-modal-compartir" class="cerrar-modal">&times;</span>
                    <p class="titulo-modal">Compartir esta rese√±a</p>
                    <div class="iconos-compartir">
                        <a href="#" target="_blank" id="compartir-whatsapp" class="icono-red">
                            <i class="ri-whatsapp-line"></i>
                        </a>
                        <a href="#" target="_blank" id="compartir-facebook" class="icono-red">
                            <i class="ri-facebook-box-line"></i>
                        </a>
                        <button class="icono-red" id="copiar-enlace">
                            <i class="ri-links-line"></i>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <section class="contenido-resena-completa">
            <p class="subtitulo-resena">El libro que mata</p>
            <br>
            <p>
                En el libro¬†‚ÄúPar√≠s no acaba nunca‚Äù¬†el autor nos cuenta el proceso creativo de esta nouvelle. Escrita en
                1975, mientras viv√≠a en la capital francesa, surge de una idea inquietante ya expresada por Miguel de
                Unamuno: quien lea el relato morir√°. Su casera en aquellos d√≠as, Margarite Duras, pretendi√≥ disuadirlo
                del intento con una serie de fundamentos que, con probabilidad, han pasado al olvido. Pero Enrique
                Vila-Matas (Barcelona, 1948) no parece ser un hombre dado a los consejos. Y verdaderamente es una pena.
                Porque uno, al final, queda con la sensaci√≥n de que el experimento tiene mucho m√°s de fallido que los
                aciertos breves de una historia contada de manera fragmentaria y desigual.
            </p>
            <br>
            <p>
                Al comienzo mismo de la novela se da la muerte de Vidal Escabia, un poeta menor y cuya obra constituye
                un plagio incesante. Muere cuando recibe una carta solicit√°ndole el pr√≥logo para la autobiograf√≠a de
                Juan Herrera, escritor de prestigio, con quien mantuvo durante a√±os correspondencia. Sin embargo el
                sobre tambi√©n contiene el manuscrito ‚ÄúLa asesina ilustrada‚Äù, escrito por Elena Villena, la remitente y
                esposa de Herrera, unas seis p√°ginas redactadas en prosa po√©tica, cuya lectura tiene la propiedad de
                matar a quien las lee. Si en ‚ÄúEl nombre de la rosa‚Äù la muerte era provocada por el veneno que conten√≠a
                las hojas del libro, aqu√≠ es mediante el contacto con la letra, con su simple lectura.
            </p>
            <br>
            <p>
                Inmediatamente despu√©s descubrimos que hubo otras muertes que precedieron la de Vidal Escabia. Una de
                ellas, la del propio marido ‚Äìcon quien hace a√±os no convive- la misma noche que ley√≥ el manuscrito. De
                ello ser√° testigo Ana Ca√±izal, prologuista enviada por la editorial que publicar√° la autobiograf√≠a de
                Herrera. Descubrir√° el cuaderno en el despacho del escritor, cuya portada est√° salpicada por gotas de
                sangre, que desaparece el mismo d√≠a de su muerte cuando Villena visita la casa.
                <br>
                <br>
                Quiz√°s es en lo que escribe la joven Ca√±izal donde encontramos cierto sentido a la historia. Es ella
                quien nos describe los sucesos y nos da pistas del desenlace. Lentamente ir√° contando la b√∫squeda de
                aquellas p√°ginas, primero sin saber a qui√©n pertenec√≠an, luego deduciendo con cierta l√≥gica a la autora
                de las mismas. Se establecer√° entre las dos mujeres una relaci√≥n compleja, extra√±a, que llevar√° al
                suicidio de la prologuista una vez que tambi√©n lea el manuscrito.
            </p>
            <p>
                Vila-Matas coloca en cierto desorden las cuatro partes del libro que narrar√°n la vida, obra y muerte de
                Herrera. Lo hace exprofeso buscando dotar al texto de la intriga necesaria para llegar al final. Por
                otra parte, aparecen germinalmente obsesiones que el catal√°n desarrollar√° en el futuro. Por ejemplo, la
                desaparici√≥n del autor, donde se explayar√° con soltura en ‚ÄúDoctor Pasavento‚Äù, o la constante aparici√≥n
                de textos, libros o frases de escritores inexistentes en todas sus obras, juego de una erudici√≥n algo
                cansina y repetitiva.
                <br>
                <br>
                <i>‚ÄúCerrar el libro ser√° para el lector como cerrar la losa que cubrir√° su tumba‚Äù</i>¬†nos advierte casi
                al
                final Elena Villena. Adem√°s, como si fuera poco, sentencia que el texto seguir√° circulando, cobr√°ndose
                nuevas v√≠ctimas. Por suerte no seremos testigos de esas otras muertes aunque temo que Vila-Matas estar√≠a
                encantado de saberlo. ¬†¬†¬†¬†
            </p>

            <p class="cita-final">
                <strong>Enrique Vila-Matas, ‚ÄúLa Asesina Ilustrada‚Äù</strong>, Lumen, Barcelona, 2005, 260 p√°g.
            </p>

            <p class="datos-resena">
                Rese√±a escrita por <a href="https://www.instagram.com/sergio_requel/" target="_blank"><strong>Sergio
                        Requel</strong></a><br>
                Publicado el 21 de agosto de 2025
            </p>
        </section>

        <section class="comentarios-seccion">
            <h3 class="comentarios-titulo">Comentarios</h3>

            <form id="formulario-comentario" class="comentarios-formulario">
                <label for="nombre-comentario">Nombre</label>
                <input type="text" id="nombre-comentario" required>

                <label for="mensaje-comentario">Comentario</label>
                <textarea id="mensaje-comentario" rows="4" required></textarea>

                <button type="submit">Publicar</button>
            </form>

            <div id="lista-comentarios" class="comentarios-lista"></div>
        </section>

    </main>

    <footer class="pie-pagina">
        <p class="titulo-redes">Visita nuestras redes sociales</p>
        <div class="iconos-redes">
            <a href="https://www.instagram.com/divididalatierra/?hl=en" target="_blank" class="icono-circular">
                <i class="ri-instagram-line"></i>
            </a>
            <a href="https://open.spotify.com/show/7dwCdWLFKsf4V91qTHsAdZ?si=eb28d199ae854e0b" target="_blank"
                class="icono-circular">
                <i class="ri-spotify-line"></i>
            </a>
        </div>
    </footer>


    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyCarcJJ0qwALepQg4X4fDhJMindod5Otds",
            authDomain: "latierradividida-1fc04.firebaseapp.com",
            projectId: "latierradividida-1fc04",
            storageBucket: "latierradividida-1fc04.appspot.com",
            messagingSenderId: "376435232740",
            appId: "1:376435232740:web:ccf2b9d9ed61bb46fa01f1"
        };

        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        const abrirModal = document.getElementById('abrir-modal-compartir');
        const modal = document.getElementById('modal-compartir');
        const cerrarModal = document.getElementById('cerrar-modal-compartir');
        const compartirWhatsapp = document.getElementById('compartir-whatsapp');
        const compartirFacebook = document.getElementById('compartir-facebook');
        const copiarEnlace = document.getElementById('copiar-enlace');

        // üîπ ID √∫nico de la rese√±a actual
        const rese√±aID = "resena_la_asesina_ilustrada";

        // --- Registrar visita ---
        const visitasRef = db.collection("visitas").doc(rese√±aID);
        db.runTransaction(async (transaction) => {
            const doc = await transaction.get(visitasRef);
            const visitasActuales = doc.exists ? doc.data().contador || 0 : 0;
            transaction.set(visitasRef, { contador: visitasActuales + 1 });
        }).catch((error) => {
            console.error("Error al registrar la visita:", error);
        });

        // --- Compartir enlaces ---
        const url = encodeURIComponent(window.location.href);
        const texto = encodeURIComponent('Le√© esta rese√±a: "La Asesina Ilustrada"');

        compartirWhatsapp.href = `https://api.whatsapp.com/send?text=${texto}%20${url}`;
        compartirFacebook.href = `https://www.facebook.com/sharer/sharer.php?u=${url}`;

        abrirModal.addEventListener('click', () => {
            modal.classList.remove('oculto');
        });
        cerrarModal.addEventListener('click', () => {
            modal.classList.add('oculto');
        });
        window.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.classList.add('oculto');
            }
        });

        copiarEnlace.addEventListener('click', () => {
            navigator.clipboard.writeText(window.location.href)
                .then(() => {
                    copiarEnlace.innerHTML = '<i class="ri-check-line"></i>';
                    setTimeout(() => {
                        copiarEnlace.innerHTML = '<i class="ri-links-line"></i>';
                    }, 2000);
                })
                .catch(() => {
                    alert('No se pudo copiar el enlace.');
                });
        });

        // --- Likes ---
        const botonMeGusta = document.getElementById("boton-me-gusta");
        const contadorMeGusta = document.getElementById("contador-me-gusta");

        db.collection("likes").doc(rese√±aID).get().then(doc => {
            if (doc.exists) {
                contadorMeGusta.textContent = doc.data().cantidad || 0;
            } else {
                contadorMeGusta.textContent = 0;
            }
        });

        botonMeGusta.addEventListener("click", () => {
            const docRef = db.collection("likes").doc(rese√±aID);
            db.runTransaction(async (transaction) => {
                const doc = await transaction.get(docRef);
                const cantidadActual = doc.exists ? doc.data().cantidad || 0 : 0;
                transaction.set(docRef, { cantidad: cantidadActual + 1 });
            }).then(() => {
                contadorMeGusta.textContent = parseInt(contadorMeGusta.textContent) + 1;
            }).catch((error) => {
                console.error("Error al actualizar los likes: ", error);
            });
        });

        // --- Comentarios ---
        const form = document.getElementById("formulario-comentario");
        const nombre = document.getElementById("nombre-comentario");
        const mensaje = document.getElementById("mensaje-comentario");
        const lista = document.getElementById("lista-comentarios");
        const comentariosRef = db.collection("comentarios_rese√±as").doc(rese√±aID).collection("lista");

        form.addEventListener("submit", async (e) => {
            e.preventDefault();
            if (nombre.value.trim() && mensaje.value.trim()) {
                await comentariosRef.add({
                    nombre: nombre.value.trim(),
                    mensaje: mensaje.value.trim(),
                    fecha: new Date()
                });
                nombre.value = "";
                mensaje.value = "";
                cargarComentarios();
            }
        });

        function cargarComentarios() {
            lista.innerHTML = "";
            comentariosRef.orderBy("fecha", "desc").get().then(snapshot => {
                snapshot.forEach(doc => {
                    const data = doc.data();
                    const div = document.createElement("div");
                    div.className = "comentario";
                    div.innerHTML = `<strong>${data.nombre}</strong><p>${data.mensaje}</p>`;
                    lista.appendChild(div);
                });
            });
        }
        cargarComentarios();
    </script>
</body>

</html>